---
title: "Renv For Us"
author: "Raphaelle et Marie"
date: "27/08/2019"
output: slidy_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set( )
require(tidyverse)
theme_set(theme_minimal())
```

## Que faire ? 
 ![](shéma.png){width=1000px}

## Nos premières remarques... 

- Premier mystère : On a pas la même chose :o
- Est-ce plus malin de faire d'abord les scripts ? 
- Comment faire pour que `renv::init()` ne mette pas tous les packages à jour 
- Si tu fais pas gaffe tu peux faire n'iiiimpooorte quoii
- Certains exemples ne collent pas le package à l'air en pleine evolution!

## 1 : faire un init 

```{r}
renv::init()
```


Cela créer un fichier renv.lock qui contient les versions des packges utilisés dans les scripts la version de R tout ça tout ça.. 
Mais la bonne pratique c'est de faire init direct du coup y'a pas de package dedans sauf chez Raphaelle.. 

## 2 : Vivre sa vie 

 Installer ces packages, avec la version souhaitée :
 
```{r}
renv::install("ggplot2")
```
 
 Le *install* de renv ne re-telecharge pas les packages qu'on a déjà (fonctionne avec un cache).

```{r}
renv::install("ggplot2@3.1.1")
```



## 3 : Resauvegarder son "état de package"

Attention pour ajouter dans snapshot il faut qu'il soit utilisé et sauvegarder!

```{r}
renv::snapshot()
```
 
## 4 : (Re)Vivre sa vie

## 5 : Deux possibilités 

- On est heureux avec nos nouveaux packages mis à jour 

```{r}
renv::install("ggplot2@3.1.1")
```
 
- On est triste avec nos nouveaux packages mis à jour 

```{r}
renv::restore()
```
 
 pour revenir à la version des packages d'avant


## Si on veut répliquer le code d'un petit camarade

On peut si il nous envoie son  renv.lock à jour (et son code...)

```{r}
renv::restore(lockfile = "raph.lock")
```

## On peut vérifier qu'on est bien à jour dans notre ".lock"

```{r}
renv::install("glmnet")
renv::status()
```


```{r}
renv::snapshot()
renv::status()
```

## Bugs : versions réelles / versions affichées
![](erreur2-marchepas.png){width=1000px}


## Bugs : version package
![](erreur3-versionspackage.png){width=1000px}


## Bugs : créer un init dans un markdown
Si on init dans un RMarkdown sans avoir sauvé avant le fichier .Rmd
![](renv2-knitr.png){width=1000px}
- créer
- sauver le fichier pour les packages rmd
- renv::init()

Donc renv gardien des bonnes pratiques rmd :)


## Nos premières questions... 

- Premier mystère : On a pas la même chose :o
**Bonne question**
- Est-ce plus malin de faire d'abord les scripts ? 
**Si tu fais d'abord les scripts il ajoute directement les packages sans que tu ais besoin de faire les install mais ipq c'est pas un bp**
- Si tu fais pas gaffe tu peux faire n'iiiimpooorte quoii
Voir le projet BUUUG

## Site utils : 
https://rstudio.github.io/renv/articles/renv.html
